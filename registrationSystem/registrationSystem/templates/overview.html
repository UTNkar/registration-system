<html lang="en">
  {% include "head.html" %}
  <body>
    <main class="flex-container-start-page">
      <div class="team-information">
        <form action="{% url 'overview' %}" method="POST">
          <button type='button' onclick='toggleForm(this)'>Edit</button>
          {% csrf_token %}

          <input name="id" id="id-{{other.id}}" value="{{group.id}}" type="hidden" readonly/>
          <input name="type" id="id-{{other.id}}" value="group" type="hidden" readonly/>

          <label for="members">Team members:</label>
          <ul name="members">
            {% for member in all %}
            <li>{{ member.name }}</li>
            {% endfor %}
          </ul>

          {% for name, pretty_name, value in group.properties %}
          <label for="{{ name }}">{{ pretty_name }}:</label>
          <input
            id="{{ name }}-{{ other.id }}"
            name="{{ name }}"
            value="{{ value }}"
            readonly/>
          {% endfor %}
        </form>
      </div>

      <h3>me</h3>
      <form action="{% url 'overview' %}" method='POST'>
        {% csrf_token %}
        <button type='button'
                onclick='toggleForm(this)'>
          Edit
        </button>
        <input name="id" id="id-{{user.id}}" value="{{user.id}}" type="hidden" readonly/>
        <input name="type" id="id-{{other.id}}" value="user" type="hidden" readonly/>
        {% for name, pretty_name, value in user.properties %}
        <label for="{{ name }}">{{ pretty_name }}:</label>
        <input
          id="{{ name }}-{{ user.id }}"
          name="{{ name }}"
          value="{{ value }}"
          readonly/>
        {% endfor %}
      </form>


      <h3>others</h3>
      {% for other in others %}
      <form action="{% url 'overview' %}" method='POST'>
        {% csrf_token %}
        {% if group.leader.id == user.id %}
        <button type='button'
                onclick='toggleForm(this)'>Edit</button>
        <input name="id" id="id-{{other.id}}" value="{{other.id}}" type="hidden" readonly/>
        <input name="type" id="id-{{other.id}}" value="user" type="hidden" readonly/>
        {% endif %}
        {% for name, pretty_name, value in other.properties %}
        <label for="{{ name }}">{{ pretty_name }}:</label>
        <input
          id="{{ name }}-{{ other.id }}"
          name="{{ name }}"
          value="{{ value }}"
          readonly/>
        {% endfor %}
      </form>
      {% endfor %}
      <!-- osv -->

</div>
</main>
</body>

<script type="text/javascript">
  const toggleForm = button => {
      form = event.target.parentElement
      formElements = form.querySelectorAll('input:not([name="csrfmiddlewaretoken"])');

      for (const element of formElements)
          element.toggleAttribute('readonly')

      if (formElements[0] && formElements[0].readOnly) {
          form.submit();
      } else {
          event.target.innerHTML = 'Save';
      }
  }
</script>
</html>
